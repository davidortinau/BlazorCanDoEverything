<div class="card" style="padding: 1rem; margin-bottom: 1rem;">
    <h5 style="margin: 0 0 1rem 0; font-weight: 500;">Task Categories</h5>
    
    @if (Data != null && Data.Any())
    {
        <div class="flex flex-col gap-2">
            @foreach (var item in Data)
            {
                var color = GetColorForCategory(item.Title);
                var percentage = TotalCount > 0 ? (item.Count * 100.0 / TotalCount) : 0;
                
                <div class="flex flex-row items-center gap-2" style="width: 100%;">
                    <span style="width: 120px;">@item.Title</span>
                    <div style="flex: 1; background-color: var(--md-sys-color-surface-variant); border-radius: 4px; height: 24px; overflow: hidden;">
                        <div style="width: @(percentage)%; background-color: @color; height: 100%; transition: width 0.3s;"></div>
                    </div>
                    <span style="width: 40px; text-align: right;">@item.Count</span>
                </div>
            }
        </div>
    }
    else
    {
        <p>No data available</p>
    }
</div>

@code {
    [Parameter] public List<CategoryChartData>? Data { get; set; }
    [Parameter] public List<string>? Colors { get; set; }

    private int TotalCount => Data?.Sum(d => d.Count) ?? 0;

    private static readonly string[] DefaultColors = 
    [
        "#3068df", "#8800FF", "#FF3300", "#FF9900", "#32CD32", "#FF69B4"
    ];

    private string GetColorForCategory(string title)
    {
        if (Colors != null && Data != null)
        {
            var index = Data.FindIndex(d => d.Title == title);
            if (index >= 0 && index < Colors.Count)
            {
                return Colors[index];
            }
        }
        
        var hash = Math.Abs(title.GetHashCode());
        return DefaultColors[hash % DefaultColors.Length];
    }
}
